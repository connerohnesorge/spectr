// Spectr Tasks File (JSONC)
//
// This file contains machine-readable task definitions for a Spectr change.
// JSONC format allows comments while maintaining JSON compatibility.
//
// Status Values:
//   - "pending"     : Task has not been started yet
//   - "in_progress" : Task is currently being worked on
//   - "completed"   : Task has been finished and verified
//
// Status Transitions:
//   pending -> in_progress -> completed
//
//   Tasks should only move forward through these states.
//   Do not skip states or move backward.
//
// Workflow:
//   1. BEFORE starting work on a task, mark it as "in_progress"
//   2. Complete the implementation for the task
//   3. Verify the work is correct and complete
//   4. IMMEDIATELY mark the task as "completed" after verification
//   5. Move to the next task and repeat
//
// IMPORTANT - Update Status Immediately:
//   - Update each task's status IMMEDIATELY after it transitions
//   - Do NOT batch status updates at the end of all work
//   - Do NOT wait until all tasks are done to update statuses
//   - This file should reflect accurate progress at any point in time
//   - Using a single edit to mark a task completed AND the next task
//     in_progress is allowed (this is a single transition, not batching)
//
// Note: This file is auto-generated by 'spectr accept'. Manual edits to
// task status are expected, but structure changes may be overwritten.
//

{
  "version": 1,
  "tasks": [
    {
      "id": "1.1",
      "section": "Create Skill Directory Structure",
      "description": "Create `internal/initialize/templates/skills/spectr-validate-wo-spectr-bin/` directory",
      "status": "completed"
    },
    {
      "id": "1.2",
      "section": "Create Skill Directory Structure",
      "description": "Create `scripts/` subdirectory for shell scripts",
      "status": "completed"
    },
    {
      "id": "1.3",
      "section": "Create Skill Directory Structure",
      "description": "Create `SKILL.md` with AgentSkills frontmatter (name, description, compatibility requirements)",
      "status": "completed"
    },
    {
      "id": "1.4",
      "section": "Create Skill Directory Structure",
      "description": "Document usage examples in SKILL.md (--spec, --change, --all, --json flags)",
      "status": "completed"
    },
    {
      "id": "1.5",
      "section": "Create Skill Directory Structure",
      "description": "Document validation rules in SKILL.md (matching spectr validate behavior)",
      "status": "completed"
    },
    {
      "id": "1.6",
      "section": "Create Skill Directory Structure",
      "description": "Document exit codes in SKILL.md (0=success, 1=failure, 2=usage)",
      "status": "completed"
    },
    {
      "id": "1.7",
      "section": "Create Skill Directory Structure",
      "description": "Document limitations in SKILL.md (no pre-merge validation, no cross-capability duplicates)",
      "status": "completed"
    },
    {
      "id": "2.1",
      "section": "Implement Core Script Infrastructure",
      "description": "Create `scripts/validate.sh` with proper shebang (`#!/usr/bin/env bash`)",
      "status": "completed"
    },
    {
      "id": "2.2",
      "section": "Implement Core Script Infrastructure",
      "description": "Add set flags (`set -euo pipefail`) for robust error handling",
      "status": "completed"
    },
    {
      "id": "2.3",
      "section": "Implement Core Script Infrastructure",
      "description": "Implement configuration section (SPECTR_DIR environment variable support)",
      "status": "completed"
    },
    {
      "id": "2.4",
      "section": "Implement Core Script Infrastructure",
      "description": "Implement color setup function with TTY detection (ANSI codes only if interactive)",
      "status": "completed"
    },
    {
      "id": "2.5",
      "section": "Implement Core Script Infrastructure",
      "description": "Define regex patterns matching internal/markdown/ (Requirements, Requirement, Scenario headers)",
      "status": "completed"
    },
    {
      "id": "2.6",
      "section": "Implement Core Script Infrastructure",
      "description": "Define malformed scenario patterns (3/5/6 hashtags, bold, bullets)",
      "status": "completed"
    },
    {
      "id": "2.7",
      "section": "Implement Core Script Infrastructure",
      "description": "Define delta section patterns (ADDED, MODIFIED, REMOVED, RENAMED)",
      "status": "completed"
    },
    {
      "id": "2.8",
      "section": "Implement Core Script Infrastructure",
      "description": "Define task item pattern (flexible format with optional IDs)",
      "status": "completed"
    },
    {
      "id": "2.9",
      "section": "Implement Core Script Infrastructure",
      "description": "Implement issue collection arrays and counters (ISSUES array, ISSUE_COUNTS associative array)",
      "status": "completed"
    },
    {
      "id": "2.10",
      "section": "Implement Core Script Infrastructure",
      "description": "Implement add_issue() function for standardized issue tracking",
      "status": "completed"
    },
    {
      "id": "3.1",
      "section": "Implement Spec File Validation",
      "description": "Implement validate_spec_file() function with line-by-line reading",
      "status": "completed"
    },
    {
      "id": "3.2",
      "section": "Implement Spec File Validation",
      "description": "Implement state tracking (in_requirements flag, current_requirement, requirement_line)",
      "status": "completed"
    },
    {
      "id": "3.3",
      "section": "Implement Spec File Validation",
      "description": "Implement Requirements section detection (## Requirements pattern match)",
      "status": "completed"
    },
    {
      "id": "3.4",
      "section": "Implement Spec File Validation",
      "description": "Implement requirement header parsing (### Requirement: pattern)",
      "status": "completed"
    },
    {
      "id": "3.5",
      "section": "Implement Spec File Validation",
      "description": "Implement scenario header detection (#### Scenario: pattern)",
      "status": "completed"
    },
    {
      "id": "3.6",
      "section": "Implement Spec File Validation",
      "description": "Implement SHALL/MUST keyword detection in requirement content",
      "status": "completed"
    },
    {
      "id": "3.7",
      "section": "Implement Spec File Validation",
      "description": "Implement malformed scenario detection (check_malformed_scenario function)",
      "status": "completed"
    },
    {
      "id": "3.8",
      "section": "Implement Spec File Validation",
      "description": "Implement requirement state validation (validate_requirement_state function)",
      "status": "completed"
    },
    {
      "id": "3.9",
      "section": "Implement Spec File Validation",
      "description": "Implement requirement flushing on section boundaries",
      "status": "completed"
    },
    {
      "id": "3.10",
      "section": "Implement Spec File Validation",
      "description": "Implement missing Requirements section error reporting",
      "status": "completed"
    },
    {
      "id": "4.1",
      "section": "Implement Change Delta Validation",
      "description": "Implement validate_change() function with specs directory detection",
      "status": "completed"
    },
    {
      "id": "4.2",
      "section": "Implement Change Delta Validation",
      "description": "Implement delta spec file discovery (find all spec.md under specs/)",
      "status": "completed"
    },
    {
      "id": "4.3",
      "section": "Implement Change Delta Validation",
      "description": "Implement validate_delta_spec_file() function with delta counting",
      "status": "completed"
    },
    {
      "id": "4.4",
      "section": "Implement Change Delta Validation",
      "description": "Implement delta section detection (ADDED/MODIFIED/REMOVED/RENAMED Requirements)",
      "status": "completed"
    },
    {
      "id": "4.5",
      "section": "Implement Change Delta Validation",
      "description": "Implement requirement parsing within delta sections",
      "status": "completed"
    },
    {
      "id": "4.6",
      "section": "Implement Change Delta Validation",
      "description": "Implement delta requirement validation (scenarios, SHALL/MUST for ADDED/MODIFIED)",
      "status": "completed"
    },
    {
      "id": "4.7",
      "section": "Implement Change Delta Validation",
      "description": "Implement empty delta section detection",
      "status": "completed"
    },
    {
      "id": "4.8",
      "section": "Implement Change Delta Validation",
      "description": "Implement flush_delta_requirement() function with section-specific rules",
      "status": "completed"
    },
    {
      "id": "4.9",
      "section": "Implement Change Delta Validation",
      "description": "Implement flush_delta_section() function for empty section checks",
      "status": "completed"
    },
    {
      "id": "4.10",
      "section": "Implement Change Delta Validation",
      "description": "Implement total delta count check (error if zero deltas)",
      "status": "completed"
    },
    {
      "id": "4.11",
      "section": "Implement Change Delta Validation",
      "description": "Skip scenario/SHALL validation for REMOVED requirements",
      "status": "completed"
    },
    {
      "id": "4.12",
      "section": "Implement Change Delta Validation",
      "description": "Skip normal validation for RENAMED section (different format)",
      "status": "completed"
    },
    {
      "id": "5.1",
      "section": "Implement Tasks File Validation",
      "description": "Implement validate_tasks_file() function",
      "status": "completed"
    },
    {
      "id": "5.2",
      "section": "Implement Tasks File Validation",
      "description": "Check if tasks.md exists (skip if not present)",
      "status": "completed"
    },
    {
      "id": "5.3",
      "section": "Implement Tasks File Validation",
      "description": "Count task items using flexible pattern (`- [ ]`, `- [x]`, with/without IDs)",
      "status": "completed"
    },
    {
      "id": "5.4",
      "section": "Implement Tasks File Validation",
      "description": "Report error if tasks.md exists but has zero tasks",
      "status": "completed"
    },
    {
      "id": "5.5",
      "section": "Implement Tasks File Validation",
      "description": "Provide helpful error message with expected format examples",
      "status": "completed"
    },
    {
      "id": "6.1",
      "section": "Implement Discovery Functions",
      "description": "Implement discover_specs() function using find command",
      "status": "completed"
    },
    {
      "id": "6.2",
      "section": "Implement Discovery Functions",
      "description": "Filter for directories under spectr/specs/ containing spec.md",
      "status": "completed"
    },
    {
      "id": "6.3",
      "section": "Implement Discovery Functions",
      "description": "Sort spec IDs alphabetically",
      "status": "completed"
    },
    {
      "id": "6.4",
      "section": "Implement Discovery Functions",
      "description": "Implement discover_changes() function using find command",
      "status": "completed"
    },
    {
      "id": "6.5",
      "section": "Implement Discovery Functions",
      "description": "Filter for directories under spectr/changes/ excluding 'archive'",
      "status": "completed"
    },
    {
      "id": "6.6",
      "section": "Implement Discovery Functions",
      "description": "Sort change IDs alphabetically",
      "status": "completed"
    },
    {
      "id": "6.7",
      "section": "Implement Discovery Functions",
      "description": "Handle missing directories gracefully (return empty if directory doesn't exist)",
      "status": "completed"
    },
    {
      "id": "7.1",
      "section": "Implement Validation Orchestration",
      "description": "Implement validate_single_spec() function",
      "status": "completed"
    },
    {
      "id": "7.2",
      "section": "Implement Validation Orchestration",
      "description": "Verify spec directory exists before validation",
      "status": "completed"
    },
    {
      "id": "7.3",
      "section": "Implement Validation Orchestration",
      "description": "Call validate_spec_file() for spec.md",
      "status": "completed"
    },
    {
      "id": "7.4",
      "section": "Implement Validation Orchestration",
      "description": "Implement validate_single_change() function",
      "status": "completed"
    },
    {
      "id": "7.5",
      "section": "Implement Validation Orchestration",
      "description": "Verify change directory exists before validation",
      "status": "completed"
    },
    {
      "id": "7.6",
      "section": "Implement Validation Orchestration",
      "description": "Call validate_change() for change directory",
      "status": "completed"
    },
    {
      "id": "7.7",
      "section": "Implement Validation Orchestration",
      "description": "Implement validate_all() function",
      "status": "completed"
    },
    {
      "id": "7.8",
      "section": "Implement Validation Orchestration",
      "description": "Discover and validate all specs",
      "status": "completed"
    },
    {
      "id": "7.9",
      "section": "Implement Validation Orchestration",
      "description": "Discover and validate all changes",
      "status": "completed"
    },
    {
      "id": "7.10",
      "section": "Implement Validation Orchestration",
      "description": "Aggregate results across all items",
      "status": "completed"
    },
    {
      "id": "8.1",
      "section": "Implement Output Formatting",
      "description": "Implement print_human_results() function",
      "status": "completed"
    },
    {
      "id": "8.2",
      "section": "Implement Output Formatting",
      "description": "Group issues by file path for cleaner output",
      "status": "completed"
    },
    {
      "id": "8.3",
      "section": "Implement Output Formatting",
      "description": "Print file headers followed by indented issues",
      "status": "completed"
    },
    {
      "id": "8.4",
      "section": "Implement Output Formatting",
      "description": "Apply color codes to error levels ([ERROR] in red, [WARNING] in yellow)",
      "status": "completed"
    },
    {
      "id": "8.5",
      "section": "Implement Output Formatting",
      "description": "Format issue lines with \"line X: message\" pattern",
      "status": "completed"
    },
    {
      "id": "8.6",
      "section": "Implement Output Formatting",
      "description": "Implement summary line (X passed, Y failed (E errors), Z total)",
      "status": "completed"
    },
    {
      "id": "8.7",
      "section": "Implement Output Formatting",
      "description": "Add blank line separators between failed items",
      "status": "completed"
    },
    {
      "id": "8.8",
      "section": "Implement Output Formatting",
      "description": "Implement print_json_results() function",
      "status": "completed"
    },
    {
      "id": "8.9",
      "section": "Implement Output Formatting",
      "description": "Generate JSON structure with version, items, summary fields",
      "status": "completed"
    },
    {
      "id": "8.10",
      "section": "Implement Output Formatting",
      "description": "Use jq for JSON generation if available",
      "status": "completed"
    },
    {
      "id": "8.11",
      "section": "Implement Output Formatting",
      "description": "Fallback to printf-based JSON if jq unavailable",
      "status": "completed"
    },
    {
      "id": "8.12",
      "section": "Implement Output Formatting",
      "description": "Warn user if --json requested but jq not found",
      "status": "completed"
    },
    {
      "id": "9.1",
      "section": "Implement Argument Parsing and Main Entry Point",
      "description": "Implement print_usage() function with flag documentation",
      "status": "completed"
    },
    {
      "id": "9.2",
      "section": "Implement Argument Parsing and Main Entry Point",
      "description": "Implement main() function with argument parsing loop",
      "status": "completed"
    },
    {
      "id": "9.3",
      "section": "Implement Argument Parsing and Main Entry Point",
      "description": "Parse --spec \u003cid\u003e flag and store mode/target",
      "status": "completed"
    },
    {
      "id": "9.4",
      "section": "Implement Argument Parsing and Main Entry Point",
      "description": "Parse --change \u003cid\u003e flag and store mode/target",
      "status": "completed"
    },
    {
      "id": "9.5",
      "section": "Implement Argument Parsing and Main Entry Point",
      "description": "Parse --all flag and set mode",
      "status": "completed"
    },
    {
      "id": "9.6",
      "section": "Implement Argument Parsing and Main Entry Point",
      "description": "Parse --json flag and set json_output boolean",
      "status": "completed"
    },
    {
      "id": "9.7",
      "section": "Implement Argument Parsing and Main Entry Point",
      "description": "Parse -h/--help flag and print usage",
      "status": "completed"
    },
    {
      "id": "9.8",
      "section": "Implement Argument Parsing and Main Entry Point",
      "description": "Validate required arguments (error if mode not specified)",
      "status": "completed"
    },
    {
      "id": "9.9",
      "section": "Implement Argument Parsing and Main Entry Point",
      "description": "Execute validation based on mode (spec/change/all)",
      "status": "completed"
    },
    {
      "id": "9.10",
      "section": "Implement Argument Parsing and Main Entry Point",
      "description": "Output results based on json_output flag",
      "status": "completed"
    },
    {
      "id": "9.11",
      "section": "Implement Argument Parsing and Main Entry Point",
      "description": "Exit with code 0 if no errors, 1 if errors, 2 if usage error",
      "status": "completed"
    },
    {
      "id": "10.1",
      "section": "Register Skill with Claude Code Provider",
      "description": "Open `internal/initialize/providers/claude.go`",
      "status": "completed"
    },
    {
      "id": "10.2",
      "section": "Register Skill with Claude Code Provider",
      "description": "Add `NewAgentSkillsInitializer` call in Initializers() method",
      "status": "completed"
    },
    {
      "id": "10.3",
      "section": "Register Skill with Claude Code Provider",
      "description": "Pass skill name `spectr-validate-wo-spectr-bin`",
      "status": "completed"
    },
    {
      "id": "10.4",
      "section": "Register Skill with Claude Code Provider",
      "description": "Pass target directory `.claude/skills/spectr-validate-wo-spectr-bin`",
      "status": "completed"
    },
    {
      "id": "10.5",
      "section": "Register Skill with Claude Code Provider",
      "description": "Pass TemplateManager parameter",
      "status": "completed"
    },
    {
      "id": "11.1",
      "section": "Testing and Verification",
      "description": "Test skill installation via `spectr init` (verify .claude/skills/ created)",
      "status": "completed"
    },
    {
      "id": "11.2",
      "section": "Testing and Verification",
      "description": "Verify SKILL.md has valid frontmatter",
      "status": "completed"
    },
    {
      "id": "11.3",
      "section": "Testing and Verification",
      "description": "Verify scripts/validate.sh is executable (0755 permissions)",
      "status": "completed"
    },
    {
      "id": "11.4",
      "section": "Testing and Verification",
      "description": "Test --spec validation against existing specs in spectr/specs/validation/spec.md",
      "status": "completed"
    },
    {
      "id": "11.5",
      "section": "Testing and Verification",
      "description": "Test --change validation against existing changes (pick one with deltas)",
      "status": "completed"
    },
    {
      "id": "11.6",
      "section": "Testing and Verification",
      "description": "Test --all validation to ensure discovery works",
      "status": "completed"
    },
    {
      "id": "11.7",
      "section": "Testing and Verification",
      "description": "Create test spec with missing Requirements section, verify ERROR reported",
      "status": "completed"
    },
    {
      "id": "11.8",
      "section": "Testing and Verification",
      "description": "Create test spec with requirement missing scenario, verify ERROR reported",
      "status": "completed"
    },
    {
      "id": "11.9",
      "section": "Testing and Verification",
      "description": "Create test spec with malformed scenario (3 hashtags), verify ERROR reported",
      "status": "completed"
    },
    {
      "id": "11.10",
      "section": "Testing and Verification",
      "description": "Create test change with empty ADDED section, verify ERROR reported",
      "status": "completed"
    },
    {
      "id": "11.11",
      "section": "Testing and Verification",
      "description": "Create test change with ADDED requirement missing scenario, verify ERROR reported",
      "status": "completed"
    },
    {
      "id": "11.12",
      "section": "Testing and Verification",
      "description": "Create test tasks.md with no tasks, verify ERROR reported",
      "status": "completed"
    },
    {
      "id": "11.13",
      "section": "Testing and Verification",
      "description": "Test --json output format (verify valid JSON with jq if available)",
      "status": "completed"
    },
    {
      "id": "11.14",
      "section": "Testing and Verification",
      "description": "Test color output in TTY (verify ANSI codes present)",
      "status": "completed"
    },
    {
      "id": "11.15",
      "section": "Testing and Verification",
      "description": "Test color output in pipe (verify no ANSI codes)",
      "status": "completed"
    },
    {
      "id": "11.16",
      "section": "Testing and Verification",
      "description": "Compare skill output vs `spectr validate` output for consistency",
      "status": "completed"
    },
    {
      "id": "11.17",
      "section": "Testing and Verification",
      "description": "Verify exit codes (0 for pass, 1 for fail, 2 for usage error)",
      "status": "completed"
    },
    {
      "id": "12.1",
      "section": "Documentation and Polish",
      "description": "Add inline comments to validate.sh explaining key sections",
      "status": "completed"
    },
    {
      "id": "12.2",
      "section": "Documentation and Polish",
      "description": "Add function docstrings for major validation functions",
      "status": "completed"
    },
    {
      "id": "12.3",
      "section": "Documentation and Polish",
      "description": "Add examples to SKILL.md for each validation mode",
      "status": "completed"
    },
    {
      "id": "12.4",
      "section": "Documentation and Polish",
      "description": "Document SPECTR_DIR environment variable override",
      "status": "completed"
    },
    {
      "id": "12.5",
      "section": "Documentation and Polish",
      "description": "Document jq optional dependency and fallback behavior",
      "status": "completed"
    },
    {
      "id": "12.6",
      "section": "Documentation and Polish",
      "description": "Add troubleshooting section to SKILL.md (common errors)",
      "status": "completed"
    },
    {
      "id": "12.7",
      "section": "Documentation and Polish",
      "description": "Update SKILL.md with performance notes (sequential vs parallel)",
      "status": "completed"
    }
  ]
}